source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
library(tidyverse)
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
election.y.t <- tail(election.y, 777)
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
install.packages("pROC")
install.packages("randomForest")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
roc(USREC.y, yearp, plot=TRUE)
library(pROC)
library(randomForest)
roc(USREC.y, yearp, plot=TRUE)
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
roc(USREC.y, yearp, plot=TRUE)
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
roc(USREC.y, yearp, plot=TRUE)
install.packages("pROC")
install.packages("randomForest")
library(pROC)
library(randomForest)
roc(USREC.y, yearp, plot=TRUE)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
roc(USREC.y, yearp, plot=TRUE)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
roc(USREC.y, yearp, plot=TRUE)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
roc(USREC.y, yearp, plot=TRUE)
library(pROC)
citation("pROC")
roc(USREC.y, yearp, plot=TRUE)
par(pty = "s")
roc(USREC.y, yearp, plot=TRUE)
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearexpr.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('~/.active-rstudio-document')
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/oneyear.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
roc(USREC.y, yearp, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
summary(indicators)
sd(indicators$T10YCM)
sd(indicators$USREC)
sd(indicators$`3MBER`)
sd(indicators$SPREAD)
sd(indicators$FEDFUNDS)
sd(indicators$CPIAUCSL)
sd(indicators$INDPRO)
pnorm(1.277)
pt(1.277)
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
library(tidyverse)
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
year <- lag(indicators$SPREAD, 12)
year.t <- tail(year, 771)
USREC.y <- tail(indicators$USREC, 771)
date.y <- tail(indicators$raDATE, 771)
INDPRO.y <- lag(indicators$INDPRO, 12)
INDPRO.y.t <- tail(INDPRO.y, 771)
CPI.y <- lag(indicators$CPIAUCSL, 12)
CPI.y.t <- tail(CPI.y, 771)
FFR.y <- lag(indicators$FEDFUNDS, 12)
FFR.y.t <- tail(FFR.y, 771)
election.y.t <- tail(election.y, 771)
modely <- glm(USREC.y ~ year.t, family = binomial(link="probit"))
summary(modely)
yearz <- predict(modely)
yearp <- pnorm(yearz)
p1 <- ggplot() + geom_line(aes(x=date.y, y=yearp), color="blue")
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
library(tidyverse)
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
year <- lag(indicators$SPREAD, 3)
year.t <- tail(year, 780)
USREC.y <- tail(indicators$USREC, 780)
date.y <- tail(indicators$raDATE, 780)
INDPRO.y <- lag(indicators$INDPRO, 3)
INDPRO.y.t <- tail(INDPRO.y, 780)
CPI.y <- lag(indicators$CPIAUCSL, 3)
CPI.y.t <- tail(CPI.y, 780)
FFR.y <- lag(indicators$FEDFUNDS, 3)
FFR.y.t <- tail(FFR.y, 780)
election.y.t <- tail(election.y, 780)
modely <- glm(USREC.y ~ year.t, family = binomial(link="probit"))
summary(modely)
yearz <- predict(modely)
yearp <- pnorm(yearz)
p1 <- ggplot() + geom_line(aes(x=date.y, y=yearp), color="blue")
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
ty")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date, y=USREC),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date, y=USREC),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date, y=USREC),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
library(tidyverse)
p1+geom_col(aes(x=date, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
p1+geom_col(aes(x=date, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
library(tidyverse)
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
spread <- lag(indicators$SPREAD, 12)
spread.t <- tail(year, 771)
USREC.t <- tail(indicators$USREC, 771)
date.t <- tail(indicators$raDATE, 771)
INDPRO <- lag(indicators$INDPRO, 12)
INDPRO.t <- tail(INDPRO, 771)
CPI <- lag(indicators$CPIAUCSL, 12)
CPI.t <- tail(CPI, 771)
FFR <- lag(indicators$FEDFUNDS, 12)
FFR.t <- tail(FFR, 771)
election.t <- tail(election.y, 771)
model <- glm(USREC.t ~ spread.t + FFR.t + INDPRO.t + CPI.t + election.t, family = binomial(link="probit"))
summary(model)
zscores <- predict(model)
probs <- pnorm(zscores)
p1 <- ggplot() + geom_line(aes(x=date.t, y=probs), color="blue")
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
year <- lag(indicators$SPREAD, 12)
year.t <- tail(year, 771)
USREC.y <- tail(indicators$USREC, 771)
date.y <- tail(indicators$raDATE, 771)
INDPRO.y <- lag(indicators$INDPRO, 12)
INDPRO.y.t <- tail(INDPRO.y, 771)
CPI.y <- lag(indicators$CPIAUCSL, 12)
CPI.y.t <- tail(CPI.y, 771)
FFR.y <- lag(indicators$FEDFUNDS, 12)
FFR.y.t <- tail(FFR.y, 771)
election.y.t <- tail(election.y, 771)
modely <- glm(USREC.y ~ year.t + FFR.y.t + CPI.y.t + INSPRO.y.t + election.y.t, family = binomial(link="probit"))
summary(modely)
yearz <- predict(modely)
yearp <- pnorm(yearz)
p1 <- ggplot() + geom_line(aes(x=date.y, y=yearp), color="blue")
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
year <- lag(indicators$SPREAD, 6)
year.t <- tail(year, 777)
USREC.y <- tail(indicators$USREC, 777)
date.y <- tail(indicators$raDATE, 777)
INDPRO.y <- lag(indicators$INDPRO, 6)
INDPRO.y.t <- tail(INDPRO.y, 777)
CPI.y <- lag(indicators$CPIAUCSL, 6)
CPI.y.t <- tail(CPI.y, 777)
FFR.y <- lag(indicators$FEDFUNDS, 6)
FFR.y.t <- tail(FFR.y, 777)
election.y.t <- tail(election.y, 777)
modely <- glm(USREC.y ~ year.t, family = binomial(link="probit"))
summary(modely)
yearz <- predict(modely)
yearp <- pnorm(yearz)
p1 <- ggplot() + geom_line(aes(x=date.y, y=yearp), color="blue")
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
year <- lag(indicators$SPREAD, 12)
year.t <- tail(year, 771)
USREC.y <- tail(indicators$USREC, 771)
date.y <- tail(indicators$raDATE, 771)
INDPRO.y <- lag(indicators$INDPRO, 12)
INDPRO.y.t <- tail(INDPRO.y, 771)
CPI.y <- lag(indicators$CPIAUCSL, 12)
CPI.y.t <- tail(CPI.y, 771)
FFR.y <- lag(indicators$FEDFUNDS, 12)
FFR.y.t <- tail(FFR.y, 771)
election.y.t <- tail(election.y, 771)
modely <- glm(USREC.y ~ year.t, family = binomial(link="probit"))
summary(modely)
yearz <- predict(modely)
yearp <- pnorm(yearz)
p1 <- ggplot() + geom_line(aes(x=date.y, y=yearp), color="blue")
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
year <- lag(indicators$SPREAD, 12)
year.t <- tail(year, 771)
USREC.y <- tail(indicators$USREC, 771)
date.y <- tail(indicators$raDATE, 771)
INDPRO.y <- lag(indicators$INDPRO, 12)
INDPRO.y.t <- tail(INDPRO.y, 771)
CPI.y <- lag(indicators$CPIAUCSL, 12)
CPI.y.t <- tail(CPI.y, 771)
FFR.y <- lag(indicators$FEDFUNDS, 12)
FFR.y.t <- tail(FFR.y, 771)
election.y.t <- tail(election.y, 771)
modely <- glm(USREC.y ~ year.t + FFR.y.t + INDPRO.y.t + CPI.y.t + election.y.t, family = binomial(link="probit"))
summary(modely)
yearz <- predict(modely)
yearp <- pnorm(yearz)
p1 <- ggplot() + geom_line(aes(x=date.y, y=yearp), color="blue")
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
year <- lag(indicators$SPREAD, 12)
year.t <- tail(year, 771)
USREC.y <- tail(indicators$USREC, 771)
date.y <- tail(indicators$raDATE, 771)
INDPRO.y <- lag(indicators$INDPRO, 12)
INDPRO.y.t <- tail(INDPRO.y, 771)
CPI.y <- lag(indicators$CPIAUCSL, 12)
CPI.y.t <- tail(CPI.y, 771)
FFR.y <- lag(indicators$FEDFUNDS, 12)
FFR.y.t <- tail(FFR.y, 771)
election.y.t <- tail(election.y, 771)
modely <- glm(USREC.y ~ year.t + FFR.y.t + CPI.y.t + INSPRO.y.t + election.y.t, family = binomial(link="probit"))
summary(modely)
yearz <- predict(modely)
yearp <- pnorm(yearz)
p1 <- ggplot() + geom_line(aes(x=date.y, y=yearp), color="blue")
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
year <- lag(indicators$SPREAD, 12)
year.t <- tail(year, 771)
USREC.y <- tail(indicators$USREC, 771)
date.y <- tail(indicators$raDATE, 771)
INDPRO.y <- lag(indicators$INDPRO, 12)
INDPRO.y.t <- tail(INDPRO.y, 771)
CPI.y <- lag(indicators$CPIAUCSL, 12)
CPI.y.t <- tail(CPI.y, 771)
FFR.y <- lag(indicators$FEDFUNDS, 12)
FFR.y.t <- tail(FFR.y, 771)
election.y.t <- tail(election.y, 771)
modely <- glm(USREC.y ~ year.t + FFR.y.t + CPI.y.t + INDPRO.y.t + election.y.t, family = binomial(link="probit"))
summary(modely)
yearz <- predict(modely)
yearp <- pnorm(yearz)
p1 <- ggplot() + geom_line(aes(x=date.y, y=yearp), color="blue")
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
year <- lag(indicators$SPREAD, 6)
year.t <- tail(year, 777)
USREC.y <- tail(indicators$USREC, 777)
date.y <- tail(indicators$raDATE, 777)
INDPRO.y <- lag(indicators$INDPRO, 6)
INDPRO.y.t <- tail(INDPRO.y, 777)
CPI.y <- lag(indicators$CPIAUCSL, 6)
CPI.y.t <- tail(CPI.y, 777)
FFR.y <- lag(indicators$FEDFUNDS, 6)
FFR.y.t <- tail(FFR.y, 777)
election.y.t <- tail(election.y, 777)
modely <- glm(USREC.y ~ year.t, family = binomial(link="probit"))
summary(modely)
yearz <- predict(modely)
yearp <- pnorm(yearz)
p1 <- ggplot() + geom_line(aes(x=date.y, y=yearp), color="blue")
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
year <- lag(indicators$SPREAD, 12)
year.t <- tail(year, 771)
USREC.y <- tail(indicators$USREC, 771)
date.y <- tail(indicators$raDATE, 771)
INDPRO.y <- lag(indicators$INDPRO, 12)
INDPRO.y.t <- tail(INDPRO.y, 771)
CPI.y <- lag(indicators$CPIAUCSL, 12)
CPI.y.t <- tail(CPI.y, 771)
FFR.y <- lag(indicators$FEDFUNDS, 12)
FFR.y.t <- tail(FFR.y, 771)
election.y.t <- tail(election.y, 771)
modely <- glm(USREC.y ~ year.t + FFR.y.t + CPI.y.t + INDPRO.y.t + election.y.t, family = binomial(link="probit"))
summary(modely)
yearz <- predict(modely)
yearp <- pnorm(yearz)
p1 <- ggplot() + geom_line(aes(x=date.y, y=yearp), color="blue")
p1+geom_col(aes(x=date.y, y=USREC.y),alpha=0.3) + xlab("") + ylab("Probability")
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
spread <- lag(indicators$SPREAD, 12)
spread.t <- tail(spread, 771)
USREC.t <- tail(indicators$USREC, 771)
date.t <- tail(indicators$raDATE, 771)
INDPRO <- lag(indicators$INDPRO, 12)
INDPRO.t <- tail(INDPRO, 771)
CPI <- lag(indicators$CPIAUCSL, 12)
CPI.t <- tail(CPI, 771)
FFR <- lag(indicators$FEDFUNDS, 12)
FFR.t <- tail(FFR, 771)
election.t <- tail(election.y, 771)
model <- glm(USREC.t ~ spread.t + FFR.t + CPI.t + INDPRO.t + election.t, family = binomial(link="probit"))
summary(model)
zscores <- predict(model)
probs <- pnorm(zscores)
p1 <- ggplot() + geom_line(aes(x=date.t, y=probs), color="blue")
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
library(tidyverse)
library(MASS)
indicators <- read_csv("Data/Aggregated Data/indicatorsfedfunds.csv",col_types = cols(USREC = col_integer(),raDATE = col_date(format = "%Y-%m")))
spread <- lag(indicators$SPREAD, 12)
spread.t <- tail(spread, 771)
USREC.t <- tail(indicators$USREC, 771)
date.t <- tail(indicators$raDATE, 771)
INDPRO <- lag(indicators$INDPRO, 12)
INDPRO.t <- tail(INDPRO, 771)
CPI <- lag(indicators$CPIAUCSL, 12)
CPI.t <- tail(CPI, 771)
FFR <- lag(indicators$FEDFUNDS, 12)
FFR.t <- tail(FFR, 771)
election.t <- tail(election.y, 771)
model <- glm(USREC.t ~ spread.t + FFR.t + CPI.t + INDPRO.t + election.t, family = binomial(link="probit"))
stepAIC(model)
summary(model)
zscores <- predict(model)
probs <- pnorm(zscores)
p1 <- ggplot() + geom_line(aes(x=date.t, y=probs), color="blue")
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
summary(stepAIC(model))
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
summary(step)
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
summary(step)
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
summary(step)
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
summary(step)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
library(pROC)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/oneyear.R')
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
summary(step)
model <- glm(USREC.t ~ spread.t + FFR.t + election.t, family = binomial(link="probit"))
summary(model)
z <- predict(model)
probs<-pnorm(z)
roc(USREC.t, probs, plot=TRUE)
roc(USREC.t, probs, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
summary(step
)
glm(USREC.t ~ spread.t + CPI.t + INDPRO.t, family = binomial(link="probit"))
model <- glm(USREC.t ~ spread.t + CPI.t + INDPRO.t, family = binomial(link="probit"))
z <- predict(model)
probs <- pnorm(z)
roc(USREC.t, probs, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
p1+geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Probability")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
library(pROC)
roc(USREC.t, probs, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
roc(USREC.t, probs, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
roc(USREC.t, probs, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
roc(USREC.t, probs, plot=TRUE, legacy.axes=TRUE, percent=TRUE, xlab="False Positive Percentage", ylab="True Positive Percentage")
ggdistribution(pnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'red')
install.packages("ggdistribute")
ggdistribution(pnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'red')
library(ggdistribute)
ggdistribution(pnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'red')
install.packages("ggfortify")
ggdistribution(pnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'red')
library(ggfortify)
ggdistribution(pnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'red')
ggdistribution(pnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'blue')
ggplot(indicators, aes(x=raDATE, y=SPREAD)) + geom_line(color="blue") + geom_abline(slope=0, intercept=0) + xlab("") + ylab("Treasury Spread")
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
sumary(model)
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/sixmonths.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/yearfinal.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
summary(model)
source('C:/Users/ojame/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
summary(model)
library(tidyverse)
ggplot() + stat_function(fun=dnorm)
ggplot() + stat_function(fun=dnorm, args= list(mean=0, sd=1))
ggplot() + stat_function(fun=dnorm(mean=0, sd=1)
)
ggplot() + stat_function(fun=dnorm(mean=0, sd=1))
library(ggdistribute)
ggdistribution(dnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'blue')
library(ggfortify)
ggdistribution(pnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'blue')
ggdistribution(dnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'blue')
ggdistribution(pnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'blue', fill='grey')
ggdistribution(dnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'blue')
ggdistribution(dnorm, seq(-3, 3, 0.1), mean = 0, sd = 1, colour = 'blue', fill='grey')
ggdistribution(dnorm, seq(-4, 4, 0.1), mean = 0, sd = 1, colour = 'blue', fill='grey')
ggplot(indicators, aes(x=raDATE, y=SPREAD)) + geom_line(color="blue") + geom_abline(slope=0, intercept=0) + geom_col(aes(x=date.t, y=USREC.t),alpha=0.3) + xlab("") + ylab("Treasury Spread")
ggplot(indicators, aes(x=raDATE, y=SPREAD)) + geom_line(color="blue") + geom_abline(slope=0, intercept=0) + geom_col(aes(x=raDATE, y=USREC.t),alpha=0.3) + xlab("") + ylab("Treasury Spread")
ggplot(indicators, aes(x=raDATE, y=SPREAD)) + geom_line(color="blue") + geom_abline(slope=0, intercept=0) + geom_col(aes(x=date.t, y=USREC),alpha=0.3) + xlab("") + ylab("Treasury Spread")
ggplot(indicators, aes(x=raDATE, y=SPREAD)) + geom_line(color="blue") + geom_abline(slope=0, intercept=0) + geom_col(aes(x=raDATE, y=USREC),alpha=0.3) + xlab("") + ylab("Treasury Spread")
indicators %>% mutate(election=(indicators$raDATE %>% parse_date(format="%Y-%m") %>% year() %>% mod(4) %>% {ifelse(. = 0, 1, 0)}))
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonth.R')
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/threemonths.R')
summary(election.t)
sd(election.t)
source('C:/Users/Oliver/Google Drive/Documents/Fitchburg State/Fall 2019/Senior Seminar in Applied Math/R Projects/Seminar Project/twoyears.R')
summary(step)
install.packages(c("backports", "BH", "broom", "callr", "car", "carData", "cli", "curl", "data.table", "DBI", "digest", "ellipsis", "haven", "hms", "htmltools", "htmlwidgets", "knitr", "later", "maptools", "openxlsx", "pkgconfig", "plyr", "promises", "purrr", "quantreg", "R6", "Rcpp", "RcppEigen", "rlang", "rmarkdown", "rvest", "scales", "selectr", "shiny", "sp", "SparseM", "tidyverse", "tinytex", "vctrs", "webshot", "xfun"))
install.packages(c("backports", "BH", "broom", "callr", "car", "carData", "cli", "curl", "data.table", "DBI", "digest", "ellipsis", "haven", "hms", "htmltools", "htmlwidgets", "knitr", "later", "maptools", "openxlsx", "pkgconfig", "plyr", "promises", "purrr", "quantreg", "R6", "Rcpp", "RcppEigen", "rlang", "rmarkdown", "rvest", "scales", "selectr", "shiny", "sp", "SparseM", "tidyverse", "tinytex", "vctrs", "webshot", "xfun"))
install.packages(c("backports", "BH", "broom", "callr", "car", "carData", "cli", "curl", "data.table", "DBI", "digest", "ellipsis", "haven", "hms", "htmltools", "htmlwidgets", "knitr", "later", "maptools", "openxlsx", "pkgconfig", "plyr", "promises", "purrr", "quantreg", "R6", "Rcpp", "RcppEigen", "rlang", "rmarkdown", "rvest", "scales", "selectr", "shiny", "sp", "SparseM", "tidyverse", "tinytex", "vctrs", "webshot", "xfun"))
install.packages(c("backports", "BH", "broom", "callr", "car", "carData", "cli", "curl", "data.table", "DBI", "digest", "ellipsis", "haven", "hms", "htmltools", "htmlwidgets", "knitr", "later", "maptools", "openxlsx", "pkgconfig", "plyr", "promises", "purrr", "quantreg", "R6", "Rcpp", "RcppEigen", "rlang", "rmarkdown", "rvest", "scales", "selectr", "shiny", "sp", "SparseM", "tidyverse", "tinytex", "vctrs", "webshot", "xfun"))
install.packages(c("backports", "BH", "broom", "callr", "car", "carData", "cli", "curl", "data.table", "DBI", "digest", "ellipsis", "haven", "hms", "htmltools", "htmlwidgets", "knitr", "later", "maptools", "openxlsx", "pkgconfig", "plyr", "promises", "purrr", "quantreg", "R6", "Rcpp", "RcppEigen", "rlang", "rmarkdown", "rvest", "scales", "selectr", "shiny", "sp", "SparseM", "tidyverse", "tinytex", "vctrs", "webshot", "xfun"))
install.packages(c("backports", "BH", "broom", "callr", "car", "carData", "cli", "curl", "data.table", "DBI", "digest", "ellipsis", "haven", "hms", "htmltools", "htmlwidgets", "knitr", "later", "maptools", "openxlsx", "pkgconfig", "plyr", "promises", "purrr", "quantreg", "R6", "Rcpp", "RcppEigen", "rlang", "rmarkdown", "rvest", "scales", "selectr", "shiny", "sp", "SparseM", "tidyverse", "tinytex", "vctrs", "webshot", "xfun"))
install.packages(c("purrr", "Rcpp", "rlang", "scales", "SparseM", "vctrs"))
install.packages(c("purrr", "Rcpp", "rlang", "scales", "SparseM", "vctrs"))
install.packages(c("purrr", "Rcpp", "rlang", "scales", "SparseM", "vctrs"))
